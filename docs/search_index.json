[["repdrocuing.html", "Chapter 6 Repdrocuing 6.1 Getting the data 6.2 Normalizing the data 6.3 Visualizing the data 6.4 Normalizing the data again 6.5 Visualizing the data again", " Chapter 6 Repdrocuing In this part we will be reproducing an analysis with data supplied by J. Louter (INT/ILC) Different compounds were tested on adult C.elegans and the amount of offspring were counted. 6.1 Getting the data First we will need to get the data from somewhere, we use wget to download the excel file from github. # Go to data_raw cd data_raw/ # Download the excel sheet dataset wget -O &quot;CE.LIQ.FLOW.062_Tidydata.xlsx&quot; https://github.com/DataScienceILC/tlsc-dsfb26v-20_workflows/raw/main/data/CE.LIQ.FLOW.062_Tidydata.xlsx Now we can read the file into R. # Load libraries library(readxl) library(dplyr) ## ## Attaching package: &#39;dplyr&#39; ## The following objects are masked from &#39;package:stats&#39;: ## ## filter, lag ## The following objects are masked from &#39;package:base&#39;: ## ## intersect, setdiff, setequal, union # Read the excel file C.elegans_data &lt;- read_excel(path = &quot;data_raw/CE.LIQ.FLOW.062_Tidydata.xlsx&quot;) The file is now read into R. 6.2 Normalizing the data # Display the important rows C.elegans_data %&gt;% select(c(RawData, compName, compConcentration)) ## # A tibble: 360 × 3 ## RawData compName compConcentration ## &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; ## 1 44 2,6-diisopropylnaphthalene 4.99 ## 2 37 2,6-diisopropylnaphthalene 4.99 ## 3 45 2,6-diisopropylnaphthalene 4.99 ## 4 47 2,6-diisopropylnaphthalene 4.99 ## 5 41 2,6-diisopropylnaphthalene 4.99 ## 6 35 2,6-diisopropylnaphthalene 4.99 ## 7 41 2,6-diisopropylnaphthalene 4.99 ## 8 36 2,6-diisopropylnaphthalene 4.99 ## 9 40 2,6-diisopropylnaphthalene 4.99 ## 10 38 2,6-diisopropylnaphthalene 4.99 ## # … with 350 more rows Here we see that compConcentration is of chr type, so we have to change it into a numeric type. # Load readr library(readr) # Use parse_number to change the conecentration into numeric C.elegans_data$compConcentration &lt;- parse_number(C.elegans_data$compConcentration) # Display the rows again C.elegans_data %&gt;% select(c(RawData, compName, compConcentration)) ## # A tibble: 360 × 3 ## RawData compName compConcentration ## &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 44 2,6-diisopropylnaphthalene 4.99 ## 2 37 2,6-diisopropylnaphthalene 4.99 ## 3 45 2,6-diisopropylnaphthalene 4.99 ## 4 47 2,6-diisopropylnaphthalene 4.99 ## 5 41 2,6-diisopropylnaphthalene 4.99 ## 6 35 2,6-diisopropylnaphthalene 4.99 ## 7 41 2,6-diisopropylnaphthalene 4.99 ## 8 36 2,6-diisopropylnaphthalene 4.99 ## 9 40 2,6-diisopropylnaphthalene 4.99 ## 10 38 2,6-diisopropylnaphthalene 4.99 ## # … with 350 more rows We can see the type is now of dbl type. 6.3 Visualizing the data # Load required libraries library(ggplot2) # Create scatterplot ggplot(C.elegans_data, aes(x = compConcentration, y = RawData, color = compName, shape = expType)) + geom_point() + labs(x = &quot;Compound Concentration (nM)&quot;, y = &quot;Raw Data Counts&quot;) ## Warning: Removed 5 rows containing missing values (geom_point). The graph is really cramped into the left part because of a couple of very high concentrations. This occurs because the concentrations are created by diluting the previous solution by 1/10. An obvious fix for this is to use an log10 transformation on the x-axis. # Create plot, note that we added + 0.01 this is becasue the log10 of 0 is undefined. # So adding 0.01 makes sure that points where concentration is 0 (controlNegative) show up in the graph ggplot(C.elegans_data, aes(x = log10(compConcentration + 0.01), y = RawData, color = compName, shape = expType)) + geom_point(position = position_jitter(width = 0.2, height = 0.2)) + # Add jitter labs(x = &quot;Log10(Compound Concentration (nM))&quot;, y = &quot;Raw Data Counts&quot;) ## Warning: Removed 5 rows containing missing values (geom_point). This looks way better, we also added some jitter to prevent points from overlapping. 6.4 Normalizing the data again We have put nanomolar(nM) on the x axis but not all the data is in nM some points are in percentage(pct) as shown below #show that both nM and pct are used C.elegans_data$compUnit %&gt;% unique() ## [1] &quot;nM&quot; &quot;pct&quot; Lets take a look to see where pct is being used. # Load DT library(DT) # Select rows where compUnit is pct and select the more important columns C.elegans_data %&gt;% filter(compUnit == &quot;pct&quot;) %&gt;% select(c(compName, expType, RawData, compConcentration, compUnit)) %&gt;% datatable(options = list(pageLength = 5)) # Show as datatable As you can see in the interactive table both the positive control and the negative control, as well as the vehicle control, are in percentage (pct). Since the concentration (pct) of the negative control is 0 (nothing added) we can ignore the negative control and focus on the other two, these are both ethanol solution with either 1,5% or 0,5% ethanol. Both the positive control and the control Vehicle A are in percentage ethanol solution. We can use a formula to transfer these to nM like the rest of the data. \\[nM=(x*10^7)/46,07\\] Where x is the percentage ethanol. Here we use this formula to change the percentages to molarity but its important to do this only in the rows where the compName is ethanol and the compunit pct. # Change compConcentration where compName is Ethanol and compUnit pct C.elegans_data$compConcentration &lt;- ifelse(C.elegans_data$compName == &quot;Ethanol&quot; &amp; C.elegans_data$compUnit == &quot;pct&quot;, (C.elegans_data$compConcentration * 10^7) / 46.07, C.elegans_data$compConcentration) Now that we changed the values from percentage to nM we can visualize the data again. 6.5 Visualizing the data again Now the data is acctually normalized we can finally visualize the data so we create a scatterplot again. ggplot(C.elegans_data, aes(x = log10(compConcentration + 0.01), y = RawData, color = compName, shape = expType)) + geom_point(position = position_jitter(width = 0.2, height = 0.2)) + # Add jitter labs(x = &quot;Log10(Compound Concentration)&quot;, y = &quot;Raw Data Counts&quot;) ## Warning: Removed 5 rows containing missing values (geom_point). We also create a faceted graph to make it a bit easier to see the different controls. # Create a faceted scatterplot with log-transformed x-axis and jitter using crosses ggplot(C.elegans_data, aes(x = log10(compConcentration + 0.01), y = RawData, color = compName)) + geom_point(shape = &quot;+&quot;, size = 3, position = position_jitter(width = 0.2, height = 0.2)) + labs(x = &quot;Log10(Compound Concentration)&quot;, y = &quot;Raw Data Counts&quot;) + facet_wrap(~expType, scales = &quot;fixed&quot;, ncol = 2) + # split graph in 4 for every exptype theme_minimal() ## Warning: Removed 5 rows containing missing values (geom_point). "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
