<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Reproducing an Analysis | Portfolio Twan</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Reproducing an Analysis | Portfolio Twan" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Reproducing an Analysis | Portfolio Twan" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Twan Samsom" />


<meta name="date" content="2023-12-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sql.html"/>
<link rel="next" href="r-package.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.31/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Portfolio Twan Samsom</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About<span></span></a></li>
<li class="chapter" data-level="2" data-path="curriculum-vitae.html"><a href="curriculum-vitae.html"><i class="fa fa-check"></i><b>2</b> Curriculum Vitae<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="curriculum-vitae.html"><a href="curriculum-vitae.html#opleidingen"><i class="fa fa-check"></i><b>2.1</b> Opleidingen<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="curriculum-vitae.html"><a href="curriculum-vitae.html#werk"><i class="fa fa-check"></i><b>2.2</b> Werk<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="curriculum-vitae.html"><a href="curriculum-vitae.html#talen"><i class="fa fa-check"></i><b>2.3</b> Talen<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="curriculum-vitae.html"><a href="curriculum-vitae.html#vaardigheden"><i class="fa fa-check"></i><b>2.4</b> Vaardigheden<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="learning-a-new-skill.html"><a href="learning-a-new-skill.html"><i class="fa fa-check"></i><b>3</b> Learning a New Skill<span></span></a></li>
<li class="chapter" data-level="4" data-path="looking-into-reproducible-science.html"><a href="looking-into-reproducible-science.html"><i class="fa fa-check"></i><b>4</b> Looking into Reproducible Science<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="looking-into-reproducible-science.html"><a href="looking-into-reproducible-science.html#per-and-polyfluoroalkyl-substances-activate-upr-pathway-induce-steatosis-and-fibrosis-in-liver-cells"><i class="fa fa-check"></i><b>4.1</b> Per‐ and polyfluoroalkyl substances activate UPR pathway, induce steatosis and fibrosis in liver cells<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="looking-into-reproducible-science.html"><a href="looking-into-reproducible-science.html#hormonal-correlates-of-pathogen-disgust-testing-the-compensatory-prophylaxis-hypothesis"><i class="fa fa-check"></i><b>4.2</b> Hormonal correlates of pathogen disgust: testing the compensatory prophylaxis hypothesis<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="sql.html"><a href="sql.html"><i class="fa fa-check"></i><b>5</b> SQL<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="sql.html"><a href="sql.html#getting-the-data"><i class="fa fa-check"></i><b>5.1</b> Getting the data<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="sql.html"><a href="sql.html#tidy-the-data"><i class="fa fa-check"></i><b>5.2</b> Tidy the data<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="sql.html"><a href="sql.html#using-sql-and-r-to-inspect-data"><i class="fa fa-check"></i><b>5.3</b> Using SQL and R to inspect data<span></span></a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="sql.html"><a href="sql.html#gapminder"><i class="fa fa-check"></i><b>5.3.1</b> Gapminder<span></span></a></li>
<li class="chapter" data-level="5.3.2" data-path="sql.html"><a href="sql.html#flu"><i class="fa fa-check"></i><b>5.3.2</b> Flu<span></span></a></li>
<li class="chapter" data-level="5.3.3" data-path="sql.html"><a href="sql.html#dengue"><i class="fa fa-check"></i><b>5.3.3</b> Dengue<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sql.html"><a href="sql.html#summarzing-flu-and-dengue"><i class="fa fa-check"></i><b>5.4</b> Summarzing flu and dengue<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="sql.html"><a href="sql.html#merging-the-tables"><i class="fa fa-check"></i><b>5.5</b> Merging the tables<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="sql.html"><a href="sql.html#creating-some-plots"><i class="fa fa-check"></i><b>5.6</b> Creating some plots<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="reproducing-an-analysis.html"><a href="reproducing-an-analysis.html"><i class="fa fa-check"></i><b>6</b> Reproducing an Analysis<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="reproducing-an-analysis.html"><a href="reproducing-an-analysis.html#getting-the-data-1"><i class="fa fa-check"></i><b>6.1</b> Getting the data<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="reproducing-an-analysis.html"><a href="reproducing-an-analysis.html#normalizing-the-data"><i class="fa fa-check"></i><b>6.2</b> Normalizing the data<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="reproducing-an-analysis.html"><a href="reproducing-an-analysis.html#visualizing-the-data"><i class="fa fa-check"></i><b>6.3</b> Visualizing the data<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="reproducing-an-analysis.html"><a href="reproducing-an-analysis.html#normalizing-the-data-again"><i class="fa fa-check"></i><b>6.4</b> Normalizing the data again<span></span></a></li>
<li class="chapter" data-level="6.5" data-path="reproducing-an-analysis.html"><a href="reproducing-an-analysis.html#visualizing-the-data-again"><i class="fa fa-check"></i><b>6.5</b> Visualizing the data again<span></span></a></li>
<li class="chapter" data-level="6.6" data-path="reproducing-an-analysis.html"><a href="reproducing-an-analysis.html#step-wise-plan-for-dose-response-curve-analysis"><i class="fa fa-check"></i><b>6.6</b> Step-wise Plan for Dose-Response Curve Analysis<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="r-package.html"><a href="r-package.html"><i class="fa fa-check"></i><b>7</b> R package<span></span></a></li>
<li class="chapter" data-level="8" data-path="introduction-to-projecticum.html"><a href="introduction-to-projecticum.html"><i class="fa fa-check"></i><b>8</b> Introduction to projecticum<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="introduction-to-projecticum.html"><a href="introduction-to-projecticum.html#introductie"><i class="fa fa-check"></i><b>8.1</b> Introductie<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="introduction-to-projecticum.html"><a href="introduction-to-projecticum.html#plasmiden"><i class="fa fa-check"></i><b>8.2</b> Plasmiden<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="introduction-to-projecticum.html"><a href="introduction-to-projecticum.html#one-health"><i class="fa fa-check"></i><b>8.3</b> One Health<span></span></a></li>
<li class="chapter" data-level="8.4" data-path="introduction-to-projecticum.html"><a href="introduction-to-projecticum.html#het-project"><i class="fa fa-check"></i><b>8.4</b> Het Project<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Portfolio Twan</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reproducing-an-analysis" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Reproducing an Analysis<a href="reproducing-an-analysis.html#reproducing-an-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this part we will be reproducing an analysis with data supplied by J. Louter (INT/ILC) Different compounds were tested on adult C.elegans and the amount of offspring were counted.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="reproducing-an-analysis.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb23-2"><a href="reproducing-an-analysis.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb23-3"><a href="reproducing-an-analysis.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb23-4"><a href="reproducing-an-analysis.html#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb23-5"><a href="reproducing-an-analysis.html#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb23-6"><a href="reproducing-an-analysis.html#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<div id="getting-the-data-1" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Getting the data<a href="reproducing-an-analysis.html#getting-the-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First we will need to get the data from somewhere, we use wget to download the excel file from github.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="reproducing-an-analysis.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Go to raw_data</span></span>
<span id="cb24-2"><a href="reproducing-an-analysis.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> c.elegans/raw_data/ </span>
<span id="cb24-3"><a href="reproducing-an-analysis.html#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="reproducing-an-analysis.html#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the excel sheet dataset</span></span>
<span id="cb24-5"><a href="reproducing-an-analysis.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> <span class="at">-O</span> <span class="st">&quot;CE.LIQ.FLOW.062_Tidydata.xlsx&quot;</span> https://github.com/DataScienceILC/tlsc-dsfb26v-20_workflows/raw/main/data/CE.LIQ.FLOW.062_Tidydata.xlsx</span></code></pre></div>
<p>Now we can read the file into R.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="reproducing-an-analysis.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the excel file</span></span>
<span id="cb25-2"><a href="reproducing-an-analysis.html#cb25-2" aria-hidden="true" tabindex="-1"></a>C.elegans_data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">&quot;c.elegans/raw_data/CE.LIQ.FLOW.062_Tidydata.xlsx&quot;</span>)</span></code></pre></div>
<p>The file is now read into R.</p>
</div>
<div id="normalizing-the-data" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Normalizing the data<a href="reproducing-an-analysis.html#normalizing-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="reproducing-an-analysis.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the important rows</span></span>
<span id="cb26-2"><a href="reproducing-an-analysis.html#cb26-2" aria-hidden="true" tabindex="-1"></a>C.elegans_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(RawData, compName, compConcentration)) </span></code></pre></div>
<pre><code>## # A tibble: 360 × 3
##    RawData compName                   compConcentration
##      &lt;dbl&gt; &lt;chr&gt;                      &lt;chr&gt;            
##  1      44 2,6-diisopropylnaphthalene 4.99             
##  2      37 2,6-diisopropylnaphthalene 4.99             
##  3      45 2,6-diisopropylnaphthalene 4.99             
##  4      47 2,6-diisopropylnaphthalene 4.99             
##  5      41 2,6-diisopropylnaphthalene 4.99             
##  6      35 2,6-diisopropylnaphthalene 4.99             
##  7      41 2,6-diisopropylnaphthalene 4.99             
##  8      36 2,6-diisopropylnaphthalene 4.99             
##  9      40 2,6-diisopropylnaphthalene 4.99             
## 10      38 2,6-diisopropylnaphthalene 4.99             
## # … with 350 more rows</code></pre>
<p>Here we see that compConcentration is of chr type, so we have to change it into a numeric type.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="reproducing-an-analysis.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use parse_number to change the conecentration into numeric</span></span>
<span id="cb28-2"><a href="reproducing-an-analysis.html#cb28-2" aria-hidden="true" tabindex="-1"></a>C.elegans_data<span class="sc">$</span>compConcentration <span class="ot">&lt;-</span> <span class="fu">parse_number</span>(C.elegans_data<span class="sc">$</span>compConcentration)</span>
<span id="cb28-3"><a href="reproducing-an-analysis.html#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="reproducing-an-analysis.html#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the rows again</span></span>
<span id="cb28-5"><a href="reproducing-an-analysis.html#cb28-5" aria-hidden="true" tabindex="-1"></a>C.elegans_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(RawData, compName, compConcentration)) </span></code></pre></div>
<pre><code>## # A tibble: 360 × 3
##    RawData compName                   compConcentration
##      &lt;dbl&gt; &lt;chr&gt;                                  &lt;dbl&gt;
##  1      44 2,6-diisopropylnaphthalene              4.99
##  2      37 2,6-diisopropylnaphthalene              4.99
##  3      45 2,6-diisopropylnaphthalene              4.99
##  4      47 2,6-diisopropylnaphthalene              4.99
##  5      41 2,6-diisopropylnaphthalene              4.99
##  6      35 2,6-diisopropylnaphthalene              4.99
##  7      41 2,6-diisopropylnaphthalene              4.99
##  8      36 2,6-diisopropylnaphthalene              4.99
##  9      40 2,6-diisopropylnaphthalene              4.99
## 10      38 2,6-diisopropylnaphthalene              4.99
## # … with 350 more rows</code></pre>
<p>We can see the type is now of dbl type.</p>
</div>
<div id="visualizing-the-data" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Visualizing the data<a href="reproducing-an-analysis.html#visualizing-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="reproducing-an-analysis.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatterplot</span></span>
<span id="cb30-2"><a href="reproducing-an-analysis.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(C.elegans_data, <span class="fu">aes</span>(<span class="at">x =</span> compConcentration, <span class="at">y =</span> RawData, <span class="at">color =</span> compName, <span class="at">shape =</span> expType)) <span class="sc">+</span></span>
<span id="cb30-3"><a href="reproducing-an-analysis.html#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-4"><a href="reproducing-an-analysis.html#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Compound Concentration (nM)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Raw Data Counts&quot;</span>) </span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>The graph is really cramped into the left part because of a couple of very high concentrations. This occurs because the concentrations are created by diluting the previous solution by 1/10, so the concentrations are exponential.</p>
<p>An obvious fix for this is to use an log10 transformation on the x-axis.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="reproducing-an-analysis.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot, note that we added + 0.01 this is becasue the log10 of 0 is undefined.</span></span>
<span id="cb32-2"><a href="reproducing-an-analysis.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># So adding 0.01 makes sure that points where concentration is 0 (controlNegative) show up in the graph</span></span>
<span id="cb32-3"><a href="reproducing-an-analysis.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(C.elegans_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(compConcentration <span class="sc">+</span> <span class="fl">0.01</span>), <span class="at">y =</span> RawData, <span class="at">color =</span> compName, <span class="at">shape =</span> expType)) <span class="sc">+</span></span>
<span id="cb32-4"><a href="reproducing-an-analysis.html#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> <span class="co"># Add jitter</span></span>
<span id="cb32-5"><a href="reproducing-an-analysis.html#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Log10(Compound Concentration (nM))&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Raw Data Counts&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>This looks way better, we also added some jitter to prevent points from overlapping.</p>
</div>
<div id="normalizing-the-data-again" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Normalizing the data again<a href="reproducing-an-analysis.html#normalizing-the-data-again" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have put nanomolar(nM) on the x axis but not all the data is in nM some points are in percentage(pct) as shown below</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="reproducing-an-analysis.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#show that both nM and pct are used</span></span>
<span id="cb34-2"><a href="reproducing-an-analysis.html#cb34-2" aria-hidden="true" tabindex="-1"></a>C.elegans_data<span class="sc">$</span>compUnit <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span></code></pre></div>
<pre><code>## [1] &quot;nM&quot;  &quot;pct&quot;</code></pre>
<p>Lets take a look to see where pct is being used.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="reproducing-an-analysis.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select rows where compUnit is pct and select the more important columns</span></span>
<span id="cb36-2"><a href="reproducing-an-analysis.html#cb36-2" aria-hidden="true" tabindex="-1"></a>C.elegans_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(compUnit <span class="sc">==</span> <span class="st">&quot;pct&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(compName, expType, RawData, compConcentration, compUnit)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="reproducing-an-analysis.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">5</span>)) <span class="co"># Show as datatable</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-81b92714a3296af50696" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-81b92714a3296af50696">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90"],["Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","S-medium","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol","Ethanol"],["controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlPositive","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlNegative","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA","controlVehicleA"],[54,63,54,71,53,58,60,48,53,60,42,38,36,42,35,65,49,48,50,54,51,43,45,55,45,50,46,39,45,30,92,101,106,104,93,73,94,104,78,103,63,85,62,75,82,88,85,67,65,81,85,83,74,75,85,95,99,100,98,82,73,74,75,65,83,107,93,86,99,81,108,92,88,107,87,95,98,77,80,101,104,103,90,99,104,107,87,92,97,103],[1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5],["pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct","pct"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>compName<\/th>\n      <th>expType<\/th>\n      <th>RawData<\/th>\n      <th>compConcentration<\/th>\n      <th>compUnit<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"compName","targets":1},{"name":"expType","targets":2},{"name":"RawData","targets":3},{"name":"compConcentration","targets":4},{"name":"compUnit","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>As you can see in the interactive table both the positive control and the negative control, as well as the vehicle control, are in percentage (pct). Since the concentration (pct) of the negative control is 0 (nothing added) we can ignore the negative control and focus on the other two, these are both ethanol solution with either 1,5% or 0,5% ethanol.</p>
<p>Both the positive control and the control Vehicle A are in percentage ethanol solution. We can use a formula to transfer these to nM like the rest of the data. <span class="math display">\[nM=(x*10^7)/46,07\]</span> Where x is the percentage ethanol. Here we use this formula to change the percentages to molarity but its important to do this only in the rows where the compName is ethanol and the compunit pct.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="reproducing-an-analysis.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change compConcentration where compName is Ethanol and compUnit pct</span></span>
<span id="cb37-2"><a href="reproducing-an-analysis.html#cb37-2" aria-hidden="true" tabindex="-1"></a>C.elegans_data<span class="sc">$</span>compConcentration <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(C.elegans_data<span class="sc">$</span>compName <span class="sc">==</span> <span class="st">&quot;Ethanol&quot;</span> <span class="sc">&amp;</span> C.elegans_data<span class="sc">$</span>compUnit <span class="sc">==</span> <span class="st">&quot;pct&quot;</span>,</span>
<span id="cb37-3"><a href="reproducing-an-analysis.html#cb37-3" aria-hidden="true" tabindex="-1"></a>                                            (C.elegans_data<span class="sc">$</span>compConcentration <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">7</span>) <span class="sc">/</span> <span class="fl">46.07</span>,</span>
<span id="cb37-4"><a href="reproducing-an-analysis.html#cb37-4" aria-hidden="true" tabindex="-1"></a>                                            C.elegans_data<span class="sc">$</span>compConcentration)</span></code></pre></div>
<p>Now that we changed the values from percentage to nM we can visualize the data again.</p>
</div>
<div id="visualizing-the-data-again" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Visualizing the data again<a href="reproducing-an-analysis.html#visualizing-the-data-again" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now the data is acctually normalized we can finally visualize the data so we create a scatterplot again.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="reproducing-an-analysis.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(C.elegans_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(compConcentration <span class="sc">+</span> <span class="fl">0.01</span>), <span class="at">y =</span> RawData, <span class="at">color =</span> compName, <span class="at">shape =</span> expType)) <span class="sc">+</span></span>
<span id="cb38-2"><a href="reproducing-an-analysis.html#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> <span class="co"># Add jitter</span></span>
<span id="cb38-3"><a href="reproducing-an-analysis.html#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Log10(Compound Concentration)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Raw Data Counts&quot;</span>) </span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>We also create a faceted graph to make it a bit easier to see the different controls.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="reproducing-an-analysis.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a faceted scatterplot with log-transformed x-axis and jitter using crosses</span></span>
<span id="cb40-2"><a href="reproducing-an-analysis.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(C.elegans_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(compConcentration <span class="sc">+</span> <span class="fl">0.01</span>), <span class="at">y =</span> RawData, <span class="at">color =</span> compName)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="reproducing-an-analysis.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="st">&quot;+&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb40-4"><a href="reproducing-an-analysis.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Log10(Compound Concentration)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Raw Data Counts&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-5"><a href="reproducing-an-analysis.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>expType, <span class="at">scales =</span> <span class="st">&quot;fixed&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># split graph in 4 for every exptype</span></span>
<span id="cb40-6"><a href="reproducing-an-analysis.html#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>The negative control for this experiment is S-medium 0 nM so basically nothing is added, and the positive control is a high concentration ethanol.</p>
<blockquote>
<p><em>Think about how you would analyze this experiment to learn whether there is indeed an effect of different concentrations on offspring count and whether the different compounds have a different curve (IC50). Write down you analysis as a step-wise plan.</em></p>
</blockquote>
<p>Normalizing the data for the negative control helps compare different compounds fairly. It removes baseline differences and it makes it easier to see the specific effects of each compound on offspring count.</p>
<p>Normalize data so the mean of the negative control is 1.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="reproducing-an-analysis.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the mean of controlNegative</span></span>
<span id="cb42-2"><a href="reproducing-an-analysis.html#cb42-2" aria-hidden="true" tabindex="-1"></a>controlNegative_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(C.elegans_data<span class="sc">$</span>RawData[C.elegans_data<span class="sc">$</span>expType <span class="sc">==</span> <span class="st">&quot;controlNegative&quot;</span>], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-3"><a href="reproducing-an-analysis.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use mean to nomralize data</span></span>
<span id="cb42-4"><a href="reproducing-an-analysis.html#cb42-4" aria-hidden="true" tabindex="-1"></a>C.elegans_data <span class="ot">&lt;-</span> C.elegans_data <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="reproducing-an-analysis.html#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Normalized_RawData =</span> RawData <span class="sc">/</span> controlNegative_mean)</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="reproducing-an-analysis.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(C.elegans_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(compConcentration <span class="sc">+</span> <span class="fl">0.01</span>), <span class="at">y =</span> Normalized_RawData, <span class="at">color =</span> compName, <span class="at">shape =</span> expType)) <span class="sc">+</span></span>
<span id="cb43-2"><a href="reproducing-an-analysis.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb43-3"><a href="reproducing-an-analysis.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Log10(Compound Concentration)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Normalized Raw Data&quot;</span>) </span></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
<div id="step-wise-plan-for-dose-response-curve-analysis" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Step-wise Plan for Dose-Response Curve Analysis<a href="reproducing-an-analysis.html#step-wise-plan-for-dose-response-curve-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Usually after normalizing the results like this, dose response curves are made to assess whether different concentrations have a different effect on the offspring count, and to find out how the curves from the different compounds compare to each other.</p>
One way to do this is using the <a href="https://cran.r-project.org/web/packages/drc/index.html">{drc}</a> package in R
<a href="https://github.com/RaoulWolf/FMI330" class="uri">https://github.com/RaoulWolf/FMI330</a>
<h5>
<p>Step 1, Fitting Dose-Response Curves</p>
</h5>
<p>First we should use the {drm} function from the {drc} package to fit a dose-response model for each compound.
This would look something like this:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="reproducing-an-analysis.html#cb45-1" aria-hidden="true" tabindex="-1"></a>fronds_number_inhibition.drm <span class="ot">&lt;-</span> <span class="fu">drm</span>(<span class="at">formula =</span> Normalized_RawData <span class="sc">~</span> <span class="fu">log10</span>(compConcentration <span class="sc">+</span> <span class="fl">0.01</span>),</span>
<span id="cb45-2"><a href="reproducing-an-analysis.html#cb45-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">data =</span> C.elegans_data, <span class="at">fct =</span> <span class="fu">LL.4</span>(<span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;Slope&quot;</span>, <span class="st">&quot;Lower Limit&quot;</span>, <span class="st">&quot;Upper Limit&quot;</span>, <span class="st">&quot;EC50&quot;</span>)))</span></code></pre></div>
<p>The above code doesn’t work right now but it should look something like that.</p>
<h5>
<p>Step 2, Plotting the Dose-Response Curves</p>
</h5>
<p>Now we can plot the Dose-Response Curves</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="reproducing-an-analysis.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">compConcentration =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(C.elegans_data<span class="sc">$</span>compConcentration),</span>
<span id="cb46-2"><a href="reproducing-an-analysis.html#cb46-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">to =</span> <span class="fu">max</span>(C.elegans_data<span class="sc">$</span>compConcentration),</span>
<span id="cb46-3"><a href="reproducing-an-analysis.html#cb46-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">length.out =</span> <span class="dv">1000</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="reproducing-an-analysis.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">predict</span>(fronds_number_inhibition.drm, <span class="at">newdata =</span> .), </span>
<span id="cb46-5"><a href="reproducing-an-analysis.html#cb46-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">lwr =</span> <span class="fu">predict</span>(fronds_number_inhibition.drm, <span class="at">newdata =</span> ., <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>, <span class="at">vcov. =</span> sandwich)[, <span class="dv">2</span>], </span>
<span id="cb46-6"><a href="reproducing-an-analysis.html#cb46-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">upr =</span> <span class="fu">predict</span>(fronds_number_inhibition.drm, <span class="at">newdata =</span> ., <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>, <span class="at">vcov. =</span> sandwich)[, <span class="dv">3</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb46-7"><a href="reproducing-an-analysis.html#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb46-8"><a href="reproducing-an-analysis.html#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> compConcentration, <span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb46-9"><a href="reproducing-an-analysis.html#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> compConcentration, <span class="at">y =</span> fit), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-10"><a href="reproducing-an-analysis.html#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> compConcentration, <span class="at">y =</span> Normalized_RawData), <span class="at">data =</span> C.elegans_data, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb46-11"><a href="reproducing-an-analysis.html#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Diuron (mg/L)&quot;</span>, </span>
<span id="cb46-12"><a href="reproducing-an-analysis.html#cb46-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Fronds number inhibition (%)&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-13"><a href="reproducing-an-analysis.html#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<h5>
<p>Step 3, Estimating LC50</p>
</h5>
<p>To complete the LC50 analysis, we need to extract LC50 (lethal concentration for 50% inhibition).</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="reproducing-an-analysis.html#cb47-1" aria-hidden="true" tabindex="-1"></a>lc50 <span class="ot">&lt;-</span> <span class="fu">ED</span>(fronds_number_inhibition.drm, <span class="dv">50</span>)</span></code></pre></div>
<h5>
<p>Step 4, ANOVA</p>
</h5>
<p>As the last stap we would want to test for significant differences between the compunds this could be done with an ANOVA.</p>
<p>Anova -&gt; <a href="https://www.researchgate.net/publication/278414280_Evaluation_of_the_toxicity_and_repellence_of_an_organic_fatty_acids_mixture_C8910_against_insecticide_susceptible_and_resistant_strains_of_the_major_malaria_vector_Anopheles_funestus_Giles_Diptera_Cul" class="uri">https://www.researchgate.net/publication/278414280_Evaluation_of_the_toxicity_and_repellence_of_an_organic_fatty_acids_mixture_C8910_against_insecticide_susceptible_and_resistant_strains_of_the_major_malaria_vector_Anopheles_funestus_Giles_Diptera_Cul</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sql.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-package.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/06-C.elegans.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"collapse": "section"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
